SELECT w.ID, w.WORD, w.TRANSCRIPTION, w.UKR
FROM WORD w
JOIN WORD_CATEGORY wc ON wc.WORD_ID = w.ID 
where w.ID < 11349 AND wc.CATEGORY_ID in ('custom',
'116F2CB16DD19B9A04377C53C791DE6E',
'17EC2FC86933A0648F424472B65268B1',
'2288BF04982142DFB1CFCD2FD99763A9')
order by w.ID desc;


UPDATE WORD
SET 
    UKR = (SELECT RUS FROM WORD w1
           WHERE w1.ID = WORD.ID),
    EXAMPLES_UKR = (SELECT EXAMPLES_RUS FROM WORD w2
                    WHERE w2.ID = WORD.ID)
WHERE EXISTS (
    SELECT 1 FROM WORD_CATEGORY wc
    WHERE wc.WORD_ID = WORD.ID 
    AND wc.CATEGORY_ID in ('custom',
    '116F2CB16DD19B9A04377C53C791DE6E',
    '17EC2FC86933A0648F424472B65268B1',
    '2288BF04982142DFB1CFCD2FD99763A9'))
AND WORD.UKR is NULL 
AND WORD.EXAMPLES_UKR is NULL;



SELECT DATETIME(l."TIMESTAMP", 'unixepoch') as time, WORD_ID, w.WORD, l.REPETITION, l.STATUS, l.LOCAL_DATE,
	DATETIME(w.TS_LAST_DISPLAYED, 'unixepoch') as last_rep , 
	DATETIME(w.TS_LAST_DISPLAYED + w.OFFSET_TO_NEXT_DISPLAY, 'unixepoch') as next_rep, 
	w.COUNT_REPEATED as cnt_rep
FROM LOG l
JOIN WORD w on W.ID=l.WORD_ID 
where l.WORD_ID = 11458
limit 100;



select iq.*, w.WORD  from (
	SELECT WORD_ID, COUNT() 
	FROM LOG l
	group by WORD_ID
	ORDER by COUNT() DESC
	limit 100) iq
JOIN WORD w on W.ID=iq.WORD_ID 
--11458	18	derisive